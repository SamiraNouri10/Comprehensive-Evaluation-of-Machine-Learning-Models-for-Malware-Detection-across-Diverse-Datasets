import pandas as pd
import numpy as np
# Load the dataset into a DataFrame
file_path = 'C:/Samira Files/Dataset/Second dataset/Final dataset.csv'
df = pd.read_csv(file_path)

# Replace 0 with NaN
df = df.replace(0, np.NaN)
df = df.dropna(subset=['Duration'])

# Define port mapping dictionary
port_mapping = {"UDP": 1, "TCP": 2, "RTP": 3, "ARP": 4, "ICMP": 5, "IPX/SPX": 6, "RTCP": 7}
Lablel_mapping = {"Background": 1, "LEGITIMATE": 2, "Botnet": 3}

# Map ports using the defined mapping
df['Port'] = df['Port'].map(port_mapping)
df['Label'] = df['Label'].map(Lablel_mapping)
# Write the modified DataFrame back to the original file

df.to_csv(file_path, index=False)

